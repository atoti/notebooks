# Real-time Credit Card Fraud Analysis with atoti

This use case comprises of 3 main sections:

- Generation of synthetic data with Faker for Machine Learning and simulate real-time transactions.
- Detect credit card fraud with autoML, choosing the best model with PyCaret.
- Real-time credit card analysis to investigate suspicious transaction flagged by the ML.

## 1 Synthetic data generation

[01-Synthetic-data-generation.ipynb](./01-Synthetic-data-generation.ipynb) is adapted from the GitHub repository [Sparkov_Data_Generation](https://github.com/namebrandon/Sparkov_Data_Generation). It makes use of Faker to generate customers and credit card transactions with varying profiles:

- Fraudulent / Non-fraudulent
- Male / Female
- Age groups ranging from:
  - <= 25
  - 25 - 50
  - \>= 50
- Geographical location
  - urban
  - rural
- Average transaction a day
- Weighted spending habits across:
  - the week
  - time of the year such as holiday or seasons
  - across each quarter of the year
  - time of the day (AM/PM)
- Weighted spending across various expenditure categories

We have generated data from 2021-06-01 till 2021-10-30 and they can be accessible from https://data.atoti.io/notebooks/credit-card-fraud/output.zip.

## 2 AutoML with PyCaret

[02_AutoML_PyCaret.ipynb](./02_AutoML_PyCaret.ipynb) test out the autoML [PyCaret](https://pycaret.org/) with reference to its [Binary Classification tutorial](https://github.com/pycaret/pycaret/blob/master/tutorials/Binary%20Classification%20Tutorial%20Level%20Beginner%20-%20%20CLF101.ipynb). Using PyCaret, a few models are created and trained using the data generated by the [synthetic credit card transactions generator](./01-Synthetic-data-generation.ipynb).

We save the trained models under the "model" folder for later use in performing periodic prediction as data is made available.

## 3 Real-time credit card fraud detection with atoti

[main.ipynb](./main.ipynb) can be executed independent of the other two notebooks as we have saved both the data and trained models.

This notebook covers the following:

- Loading of the data used for ML modelling in [02_AutoML_PyCaret.ipynb](./02_AutoML_PyCaret.ipynb) into atoti for EDA (exploratory data analysis).
- Create some business metrics in atoti to gather additional insights.
- Evaluate the performance of the _Light Gradient Boosting Machine (LGBM)_ model.
- Simulate real-time transactions by iterating through chunks of data with Pandas DataFrame. In each iteration:
  - we used the LGBM model to perform fraud prediction
  - load transactions and its prediction into atoti
- Evaluate incoming transaction from atoti web application on http://localhost:10327.

- Create **source simulation** in atoti with prediction from the _Decision Trees Classifier (DT)_ model. This allows us to compare the performance of the LGBM model against the DT model.
